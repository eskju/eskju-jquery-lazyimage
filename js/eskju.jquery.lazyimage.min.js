/*
 * jQuery lazyImage plugin
 *
 * Copyright (c) 2014 Christian Witte
 * licensed under MIT license.
 *
 * https://github.com/...
 *
 * Version: 0.9a
 * 
 * Licensed under MIT license.
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software 
 * and associated documentation files (the "Software"), to deal in the Software without restriction, 
 * including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, 
 * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, 
 * subject to the following conditions:
 * The above copyright notice and this permission notice shall be included in all copies or substantial 
 * portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT 
 * LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, 
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

$.fn.LazyImage=function(a){new LazyImage(this,a)};LazyImage=function(a,b){this.init(a,b)};$.extend(LazyImage.prototype,{init:function(a,b){this.selector=$(a);this.options=$.extend({classLoading:"esKju-lazyimage",classLoaded:"esKju-lazyimage-loaded",classBroken:"esKju-lazyimage-broken",applyDimensions:true,createParentContainers:true,parentContainerHtml:"<div></div>",animation:"fade",filter:"bloom"},b);this.bindImages()},applyAnimation:function(a){switch(this.options.filter){case"bloom":$(a).addClass("esKju-lazyimage-filter-bloom");break}switch(this.options.animation){case"fade":break;case"translate":$(a).addClass("esKju-lazyimage-translate");break;case"zoom":$(a).addClass("esKju-lazyimage-zoom");break;case"skew":$(a).addClass("esKju-lazyimage-skew");break}},bindImages:function(){var a=this;this.selector.each(function(b,c){c=a.createParentContainers(c);a.applyDimensions(c);a.applyAnimation(c);c=$($(c).find("img"));c.one("load",function(){a.loaded(c)}).each(function(){if(this.complete){$(this).load()}});$(c).error(function(){a.error(c)})})},createParentContainers:function(a){if(this.options.createParentContainers){if($(a).prop("tagName")=="IMG"){$(a).removeClass(this.options.classLoading);newElement=$(this.options.parentContainerHtml);newElement.addClass(this.options.classLoading);newElement.append($(a).clone());$(a).replaceWith(newElement);return newElement}}return a},applyDimensions:function(a){if(this.options.applyDimensions){imageWidth=$($(a).find("img")).width();imageHeight=$($(a).find("img")).height();$(a).css({width:imageWidth,height:imageHeight})}},loaded:function(a){$(a.parent()).addClass(this.options.classLoaded)},error:function(a){$(a.parent()).addClass(this.options.classBroken);$(a.parent()).removeClass(this.options.classLoaded)}});